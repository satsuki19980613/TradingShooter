<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, user-scalable=no, viewport-fit=cover"
    />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta
      name="apple-mobile-web-app-status-bar-style"
      content="black-translucent"
    />
    <title>TradingShooter</title>
    <link rel="stylesheet" href="style.css" />
  </head>
  <body>
    <video autoplay muted loop playsinline id="bg-video">
      <source
        src="https://trading-charge-shooter.web.app/bg_video.mp4"
        type="video/mp4"
      />
    </video>

    <div id="screen-home" class="screen active">
      <div class="screen-content">
        <h1>TradingShooter</h1>

        <button
          id="btn-audio-toggle"
          class="ui-button small"
          style="margin-bottom: 10px; border-color: #00ffea; color: #00ffea"
        >
          üîä BGM: ON
        </button>

        <button id="btn-start-game" class="ui-button primary">Join Game</button>
      </div>
    </div>
    <div id="screen-loading" class="screen">
      <div class="screen-content"><h2 id="loading-text">Loading...</h2></div>
    </div>

    <div id="screen-game" class="screen">

      <div id="cockpit-container" class="overlay-layout">
        <div id="game-field-wrapper" class="full-screen-layer">
          <div id="game-field-container">
            <canvas id="game-field" tabindex="0"></canvas>
            <canvas
              id="ui-field"
              style="position: absolute; top: 0; left: 0; pointer-events: none"
            ></canvas>
            <div id="obstacle-layer"></div>
          </div>
        </div>
        <div id="hud-layer" class="full-screen-layer">
          <div id="hud-dashboard">
            <div class="hud-upper-row">
              <div class="dashboard-item status-group">
                <div class="panel-module transparent-bg">
                  <div class="panel-header-row">
                    <h3>STATUS</h3>
                  </div>
                  <div id="hud-status-area">
                    <div class="stat-row">
                      <span class="stat-label">HP</span>
                      <div class="stat-bar-outer">
                        <div id="hp-bar-inner" class="stat-bar hp"></div>
                      </div>
                      <span id="hp-value" class="stat-value">100</span>
                    </div>
                    <div class="stat-row">
                      <span class="stat-label">EP</span>
                      <div
                        class="stat-bar-outer"
                        style="visibility: hidden; height: 0"
                      ></div>
                      <span id="ep-value" class="stat-value ep-value">100</span>
                    </div>
                    <div class="stat-row no-bar">
                      <span class="stat-label">Size</span>
                      <span id="size-value" class="stat-value">10</span>
                    </div>
                    <div class="stat-row no-bar">
                      <span class="stat-label" id="power-label">Power</span>
                      <span id="power-value" class="stat-value">0</span>
                    </div>
                  </div>
                </div>
              </div>
              <div
                id="bottom-chart-panel"
                class="panel-module transparent-bg dashboard-item"
              >
                <div id="bottom-chart-left">
                  <h3 class="chart-label-badge">MARKET CHART</h3>
                  <div class="canvas-wrapper" style="height: 100%">
                    <canvas id="chart-canvas"></canvas>
                  </div>
                </div>
                <div id="ma-selection-panel">
                  <div class="ma-option">
                    <input
                      type="checkbox"
                      id="ma-short"
                      name="ma-select"
                      value="short"
                      checked
                    /><label for="ma-short">S</label>
                  </div>
                  <div class="ma-option">
                    <input
                      type="checkbox"
                      id="ma-medium"
                      name="ma-select"
                      value="medium"
                    /><label for="ma-medium">M</label>
                  </div>
                  <div class="ma-option">
                    <input
                      type="checkbox"
                      id="ma-long"
                      name="ma-select"
                      value="long"
                      checked
                    /><label for="ma-long">L</label>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class="hud-group top-right">
            <div class="hud-row">
              <div class="panel-module transparent-bg">
                <h3>RADAR</h3>
                <div class="canvas-wrapper">
                  <canvas id="radar-canvas"></canvas>
                </div>
              </div>
              <div class="panel-module transparent-bg">
                <h3>MAGAZINE</h3>
                <div class="canvas-wrapper">
                  <canvas id="magazine-canvas"></canvas>
                </div>
              </div>
            </div>
          </div>
          <button id="btn-retire" class="ui-button small">RETIRE</button>
          <div class="hud-group bottom-left">
            <div
              id="debug-panel"
              class="ui-panel"
              style="display: none; background: rgba(0, 0, 0, 0.5)"
            >
              <h4>Stats</h4>
              <div id="debug-stats-container"></div>
              <hr />
              <div id="debug-simulation-container"></div>
            </div>
          </div>
        </div>
        <div id="mobile-controls-layer">
          <div id="mc-left-bottom">
            <div id="mc-action-cluster">
              <button id="mc-btn-settle" class="mc-btn-entry">FIX</button>
              <button id="mc-btn-short" class="mc-btn-entry">SHORT</button>
              <button id="mc-btn-fire">FIRE</button>
              <button id="mc-btn-long" class="mc-btn-entry">LONG</button>
              <div id="mc-lot-control">
                <button id="mc-btn-lot-minus" class="mc-btn-lot">-</button>
                <div id="mc-lot-display">10</div>
                <button id="mc-btn-lot-plus" class="mc-btn-lot">+</button>
              </div>
            </div>
          </div>
          <div id="mc-right-bottom">
            <div id="mc-joystick-area"><div id="mc-joystick-knob"></div></div>
          </div>
        </div>
        <div id="music-notification" class="music-notification hidden">
            <div class="music-icon">‚ô™</div>
            <div class="music-info">
              <span class="music-label">Now Playing</span>
              <span id="music-title" class="music-title">Track Name</span>
            </div>
        </div>
      </div>
    </div>

    <div id="screen-gameover" class="screen">
      <div class="screen-content">
        <h2>GAME OVER</h2>
        <p>Score: <span id="gameover-score">0</span></p>
        <button id="btn-gameover-retry" class="ui-button primary">Retry</button>
        <button id="btn-gameover-home" class="ui-button">Home</button>
      </div>
    </div>

    <div id="screen-error" class="screen">
      <div class="screen-content">
        <h2>Error</h2>
        <p id="error-message"></p>
        <button id="btn-error-home" class="ui-button">Home</button>
      </div>
    </div>

    <div id="screen-idle-warning" class="screen">
      <div class="screen-content">
        <h2>Warning</h2>
        <p>„Ç¢„Ç§„Éâ„É´Áä∂ÊÖã„ÅÆ„Åü„ÇÅÂàáÊñ≠„Åï„Çå„Åæ„Åô„ÄÇ</p>
      </div>
    </div>

    <script
      src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app.js"
      type="module"
    ></script>
    <script
      src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth.js"
      type="module"
    ></script>
    <script
      src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore.js"
      type="module"
    ></script>
    <script src="src/main.js" type="module"></script>
  </body>
</html>
